{"title":"Mybatis(1)","date":"2019-11-21T14:21:54.439Z","link":"post/Mybatis(1)","updated":"2019-11-21T14:18:26.533Z","content":"<h1 id=\"MyBatis-一\">MyBatis(一)<a href=\"post/Mybatis(1)#MyBatis-一\"></a></h1><p>搭建环境：</p>\n<ul>\n<li>JDK 1.8</li>\n<li>MySQL 8.0</li>\n<li>maven </li>\n<li>IDEA</li>\n</ul>\n<p>知识需求：</p>\n<ul>\n<li><p>JDBC</p>\n<p>MyBatis就是为了简化JDBC操作</p>\n</li>\n<li><p>MySQL</p>\n</li>\n<li><p>Java基础</p>\n</li>\n<li><p>Maven</p>\n</li>\n<li><p>Junit</p>\n</li>\n</ul>\n<p>学习建议：<strong>框架学习的最好的方式就是看官网文档！</strong>需要编写配置文件。</p>\n<p><strong>MyBatis中文官网：<a href=\"https://mybatis.org/mybatis-3/zh/\" target=\"_blank\" rel=\"noopener\">https://mybatis.org/mybatis-3/zh/</a></strong></p>\n<h2 id=\"1-简介\">1 简介<a href=\"post/Mybatis(1)#1-简介\"></a></h2><h3 id=\"1-1-什么是MyBatis\">1.1 什么是MyBatis<a href=\"post/Mybatis(1)#1-1-什么是MyBatis\"></a></h3><ul>\n<li><p>MyBatis 是一款优秀的<strong>持久层框架</strong></p>\n<blockquote>\n<h4 id=\"持久层：完成持久化工作的代码块\"><a href=\"#持久层：完成持久化工作的代码块\" class=\"headerlink\" title=\"持久层：完成持久化工作的代码块\"></a>持久层：完成持久化工作的代码块</h4><h4 id=\"持久化：将数据持久化\"><a href=\"#持久化：将数据持久化\" class=\"headerlink\" title=\"持久化：将数据持久化\"></a>持久化：将数据持久化</h4><p>持久化：将程序中的数据从<strong>瞬时状态</strong>向<strong>持久状态</strong>转化的过程</p>\n<ul>\n<li>瞬时状态：存放在内存中的数据易断电即失</li>\n<li>持久状态：存放在数据库(JDBC)、IO文件中不易丢失</li>\n</ul>\n<p>即将程序中的数据从内存中持久化进数据库(IO浪费资源)</p>\n</blockquote>\n</li>\n<li><p>它支持定制化 SQL、存储过程以及高级映射</p>\n</li>\n<li><p>MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集</p>\n</li>\n<li><p>MyBatis 可以使用简单的 XML 或注解来配置和映射原生类型、接口和 Java 的 POJO（Plain Old Java Objects，普通老式 Java 对象）为数据库中的记录</p>\n</li>\n<li><p>MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。</p>\n</li>\n</ul>\n<h3 id=\"1-2-如何获得MyBatis\">1.2 如何获得MyBatis<a href=\"post/Mybatis(1)#1-2-如何获得MyBatis\"></a></h3><ul>\n<li><p>Maven</p>\n<p>MyBatis 3.5.2</p>\n<figure class=\"highlight plain\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;3.5.2&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>GitHub:<a href=\"https://github.com/mybatis/mybatis-3/releases\" target=\"_blank\" rel=\"noopener\">https://github.com/mybatis/mybatis-3/releases</a></p>\n</li>\n</ul>\n<h3 id=\"1-3-MyBatis的优点\">1.3 MyBatis的优点<a href=\"post/Mybatis(1)#1-3-MyBatis的优点\"></a></h3><ul>\n<li>灵活： sql写在xml里，便于统一管理和优化。通过sql语句可以满足操作数据库的所有需求。</li>\n<li>解除sql与程序代码的耦合，sql和代码的分离，提高了可维护性。</li>\n<li>提供映射标签</li>\n<li>提供对象关系映射标签</li>\n<li>提供xml标签，支持编写动态sql</li>\n</ul>\n<h2 id=\"2第一个MyBatis程序\">2第一个MyBatis程序<a href=\"post/Mybatis(1)#2第一个MyBatis程序\"></a></h2><p>思路：搭建环境——&gt;导入MyBatis——&gt;编写代码——&gt;测试</p>\n<h3 id=\"2-1-搭建数据库环境\">2.1 搭建数据库环境<a href=\"post/Mybatis(1)#2-1-搭建数据库环境\"></a></h3><figure class=\"highlight plain\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-2-新建普通的Maven项目\">2.2 新建普通的Maven项目<a href=\"post/Mybatis(1)#2-2-新建普通的Maven项目\"></a></h3><ul>\n<li>在porm.xml文件中导入依赖<ul>\n<li>mybatis依赖</li>\n<li>mysql驱动依赖</li>\n<li>Junit测试依赖</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--导入依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--导入mybatis依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.5.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--导入Junit依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.12<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--导入MySQL驱动依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>8.0.17<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-3-编写MyBatis的核心配置文件\">2.3 编写MyBatis的核心配置文件<a href=\"post/Mybatis(1)#2-3-编写MyBatis的核心配置文件\"></a></h3><p>在src/main/resources目录下新建一个mybatis-config.xml文件</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE configuration</span></span><br><span class=\"line\"><span class=\"meta\">  PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">  \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--configuration:mybatis的核心配置文件--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--官网版本--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">environments</span> <span class=\"attr\">default</span>=<span class=\"string\">\"development\"</span>&gt;</span>\t\t\t</span><br><span class=\"line\">    <span class=\"comment\">&lt;!--配置环境，通过id可任意选择--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">environment</span> <span class=\"attr\">id</span>=<span class=\"string\">\"development\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">transactionManager</span> <span class=\"attr\">type</span>=<span class=\"string\">\"JDBC\"</span>/&gt;</span>\t\t\t</span><br><span class=\"line\">      <span class=\"comment\">&lt;!--事务管理，默认JDBC--&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">dataSource</span> <span class=\"attr\">type</span>=<span class=\"string\">\"POOLED\"</span>&gt;</span>\t\t\t\t</span><br><span class=\"line\">        <span class=\"comment\">&lt;!--配置数据库连接参数--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"driver\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;driver&#125;\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"url\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;url&#125;\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;username&#125;\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;password&#125;\"</span>/&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">dataSource</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">environment</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">environments</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"org/mybatis/example/BlogMapper.xml\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<p>我的mysql连接配置</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">environments</span> <span class=\"attr\">default</span>=<span class=\"string\">\"development\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">environment</span> <span class=\"attr\">id</span>=<span class=\"string\">\"development\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">transactionManager</span> <span class=\"attr\">type</span>=<span class=\"string\">\"JDBC\"</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">dataSource</span> <span class=\"attr\">type</span>=<span class=\"string\">\"POOLED\"</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"driver\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.mysql.cj.jdbc.Driver\"</span>/&gt;</span></span><br><span class=\"line\">          <span class=\"comment\">&lt;!--url中的参数解释</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t&amp;amp;\t\t\t\t\t\t——&gt;&amp;的转义形式,&amp;在此处无法使用</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\tserverTimezone=UTC\t\t\t——&gt;mysql8.0+版本必配置否则时区混乱</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\tuserSSL=true\t\t\t\t——&gt;安全连接设置为true</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\tuseUnicode=true\t\t\t\t——&gt;使用Unicode中文编码</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\tcharacterEncoding=UTF-8\t\t——&gt;编码格式为UTF-8</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t--&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"url\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;amp;userSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8\"</span>/&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"root\"</span>/&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"123456\"</span>/&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">dataSource</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">environment</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">environments</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"UserMapper.xml\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-4-编写MyBatis工具类\">2.4 编写MyBatis工具类<a href=\"post/Mybatis(1)#2-4-编写MyBatis工具类\"></a></h3><p>固定写法，无需修改可直接使用！</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.utils;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.io.Resources;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//SqlSessionFactory--&gt;SqlSession</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyBatisUtils</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class=\"line\">    <span class=\"keyword\">static</span>&#123;\t\t<span class=\"comment\">//放在static代码块中，初始时加载</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//获取SqlSessionFactory对象--&gt;使用mybatis的第一步!</span></span><br><span class=\"line\">            String resource = <span class=\"string\">\"mybatis-config.xml\"</span>;</span><br><span class=\"line\">            InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class=\"line\">            sqlSessionFactory = <span class=\"keyword\">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//有了SqlSessionFactory就可以从中获得SqlSession的实例</span></span><br><span class=\"line\">    <span class=\"comment\">//SqlSession 完全包含了面向数据库执行SQL命令所需的所有方法</span></span><br><span class=\"line\">    <span class=\"comment\">//通过SqlSession实例来直接执行已映射的 SQL 语句</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> SqlSession <span class=\"title\">getSqlSession</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sqlSessionFactory.openSession();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-5-编写代码\">2.5 编写代码<a href=\"post/Mybatis(1)#2-5-编写代码\"></a></h3><blockquote>\n<p>使用MyBatis之前，需要编写</p>\n<ul>\n<li>实体类</li>\n<li>Dao接口</li>\n<li>Dao实现类 </li>\n</ul>\n<p>使用MyBatis之后，只需编写</p>\n<ul>\n<li>实体类</li>\n<li>Mapper接口(Dao接口的MyBatis名字)</li>\n<li>配置用于绑定执行相关Mapper接口的相关Mapper.xml文件</li>\n</ul>\n</blockquote>\n<h4 id=\"2-5-1-实体类\">2.5.1 实体类<a href=\"post/Mybatis(1)#2-5-1-实体类\"></a></h4><p><strong>对应数据库表编写！</strong></p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.pojo;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String pwd;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">User</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">User</span><span class=\"params\">(<span class=\"keyword\">int</span> id, String name, String pwd)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pwd = pwd;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getPwd</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> pwd;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setPwd</span><span class=\"params\">(String pwd)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pwd = pwd;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"User&#123;\"</span> +</span><br><span class=\"line\">                <span class=\"string\">\"id=\"</span> + id +</span><br><span class=\"line\">                <span class=\"string\">\", name='\"</span> + name + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", pwd='\"</span> + pwd + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">'&#125;'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<h4 id=\"2-5-2Mapper接口\">2.5.2Mapper接口<a href=\"post/Mybatis(1)#2-5-2Mapper接口\"></a></h4><figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.pojo.User;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//查询所有学生</span></span><br><span class=\"line\">    <span class=\"function\">List&lt;User&gt; <span class=\"title\">getUserList</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号查询学生</span></span><br><span class=\"line\">    <span class=\"function\">User <span class=\"title\">getUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号删除学生</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">deleteUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//插入一条学生信息</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addUser</span><span class=\"params\">(User user)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//更新一条学生信息</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">updateUser</span><span class=\"params\">(User user)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<h4 id=\"2-5-3-配置Mapper-xml文件\">2.5.3 配置Mapper.xml文件<a href=\"post/Mybatis(1)#2-5-3-配置Mapper-xml文件\"></a></h4><p><strong>namespace中绑定的包名必须和Mapper接口的包名一致！</strong>，否则会报错。</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE mapper</span></span><br><span class=\"line\"><span class=\"meta\">        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--以上是头文件--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--namespace:绑定一个Dao/Mapper接口(即该配置文件相当于实现了Mapper接口!)--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"com.dao.UserMapper\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--select标签:select语句--&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--        id:对应接口的方法名!</span></span><br><span class=\"line\"><span class=\"comment\">\t\tresultType:返回类型，只能返回一个(类型)</span></span><br><span class=\"line\"><span class=\"comment\">\t\t resultMap:返回集合，可以返回多个(类型)</span></span><br><span class=\"line\"><span class=\"comment\">\t\t返回结果要写全限定类名！所有的集合写泛型中的类型！</span></span><br><span class=\"line\"><span class=\"comment\">\t--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"getUserList\"</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"com.pojo.User\"</span>&gt;</span></span><br><span class=\"line\">        select * from mybatis.user;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-6-编写测试用例\">2.6 编写测试用例<a href=\"post/Mybatis(1)#2-6-编写测试用例\"></a></h3><figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.pojo.User;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.utils.MyBatisUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserMapperTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//查询所有学生</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//第一步：获取SqlSession对象</span></span><br><span class=\"line\">        SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class=\"line\">        <span class=\"comment\">//执行SQL</span></span><br><span class=\"line\">        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class=\"line\">        List&lt;User&gt; userList = userMapper.getUserList();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : userList) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//关闭sqlSession流</span></span><br><span class=\"line\">        sqlSession.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"2-7-可能会遇到的错误\">2.7 可能会遇到的错误<a href=\"post/Mybatis(1)#2-7-可能会遇到的错误\"></a></h3><h4 id=\"2-7-1-Mapper在配置文件中未注册\">2.7.1 Mapper在配置文件中未注册<a href=\"post/Mybatis(1)#2-7-1-Mapper在配置文件中未注册\"></a></h4><p>报错如下:</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">org.apache.ibatis.binding.BindingException: Type <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">com</span>.<span class=\"title\">dao</span>.<span class=\"title\">UserMapper</span> <span class=\"title\">is</span> <span class=\"title\">not</span> <span class=\"title\">known</span> <span class=\"title\">to</span> <span class=\"title\">the</span> <span class=\"title\">MapperRegistry</span>.</span></span><br></pre></td></tr></table></div></figure>\n\n<p>原因：在编写<strong>mybatis的核心配置文件</strong>时未注册</p>\n<p>解决方法：在<strong>mybatis的核心配置文件</strong>中添加注册</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE configuration</span></span><br><span class=\"line\"><span class=\"meta\">  PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">  \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">environments</span> <span class=\"attr\">default</span>=<span class=\"string\">\"development\"</span>&gt;</span>\t\t\t</span><br><span class=\"line\">    ......</span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">environments</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!--每一个Mapper.xml文件都需要在MyBatis核心配置文件中注册!--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"org/mybatis/example/BlogMapper.xml\"</span>/&gt;</span>\t\t<span class=\"comment\">&lt;!--用/代替.分割目录!--&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<p><strong>每一个Mapper.xml文件都需要在MyBatis核心配置文件中注册!</strong></p>\n<h4 id=\"2-7-2-Maven资源导出问题\">2.7.2 Maven资源导出问题<a href=\"post/Mybatis(1)#2-7-2-Maven资源导出问题\"></a></h4><p>报错如下:</p>\n<p>原因:<strong>maven中约定大于配置</strong>，可能会出现配置文件无法导出或生效</p>\n<p>解决方法:在<strong>porm.xml</strong>文件中添加如下配置</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--maven中约定大于配置，可能会出现配置文件无法导出或生效解决方案如下--&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--在build中配置resource来防止资源导出失败的问题--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/*.properties<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/*.xml<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/java<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/*.properties<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>**/*.xml<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">includes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h2 id=\"3-CRUD-增删改需要提交事务sqlSession-commit\">3 CRUD(增删改需要提交事务sqlSession.commit)<a href=\"post/Mybatis(1)#3-CRUD-增删改需要提交事务sqlSession-commit\"></a></h2><blockquote>\n<p>MyBatis的便利之处就是在于初始配置之后只需修改UserMapper.java、UserMapper.xml和Test测试类即可</p>\n</blockquote>\n<h3 id=\"3-1-select：查询语句\">3.1 select：查询语句<a href=\"post/Mybatis(1)#3-1-select：查询语句\"></a></h3><ul>\n<li>id：namespace绑定的Mapper接口中的方法名</li>\n<li>resultType：SQL语句返回结果集<strong>(返回结果类型必须写全限定类名)</strong></li>\n<li>parameterType：参数类型<strong>(用”#{}”接收参数，如果参数类型是自定义类则需要写全限定类名)</strong></li>\n</ul>\n<h4 id=\"示例：根据ID查询用户名\">示例：根据ID查询用户名<a href=\"post/Mybatis(1)#示例：根据ID查询用户名\"></a></h4><ul>\n<li><p>UserMapper.java</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.pojo.User;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//查询所有学生</span></span><br><span class=\"line\">    <span class=\"function\">List&lt;User&gt; <span class=\"title\">getUserList</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号查询学生</span></span><br><span class=\"line\">    <span class=\"function\">User <span class=\"title\">getUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>UserMapper.xml</p>\n<p><strong>用”#{}”接收参数</strong></p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE mapper</span></span><br><span class=\"line\"><span class=\"meta\">        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"com.dao.UserMapper\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"getUserList\"</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"com.pojo.User\"</span>&gt;</span></span><br><span class=\"line\">        select * from mybatis.user;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"getUser\"</span> <span class=\"attr\">parameter</span>=<span class=\"string\">\"int\"</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"com.pojo.User\"</span>&gt;</span></span><br><span class=\"line\">        select * from mybatis.user where id = #&#123;id&#125;;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>Test.java</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getUser</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//第一步：获取SqlSession对象</span></span><br><span class=\"line\">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class=\"line\">    <span class=\"comment\">//执行SQL</span></span><br><span class=\"line\">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class=\"line\">    User user = userMapper.getUser(<span class=\"number\">2</span>);</span><br><span class=\"line\">    System.out.println(user);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//关闭sqlSession流</span></span><br><span class=\"line\">    sqlSession.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<h3 id=\"3-2-insert：添加语句\">3.2 insert：添加语句<a href=\"post/Mybatis(1)#3-2-insert：添加语句\"></a></h3><ul>\n<li>id：namespace绑定的Mapper接口中的方法名</li>\n<li>resultType：SQL语句返回结果集<strong>(返回结果类型必须写全限定类名)</strong></li>\n<li>parameterType：参数类型<strong>(用”#{}”接收参数，如果参数类型是自定义类则需要写全限定类名)</strong></li>\n</ul>\n<h4 id=\"示例：根据学号插入学生信息\"><strong>示例：根据学号插入学生信息</strong><a href=\"post/Mybatis(1)#示例：根据学号插入学生信息\"></a></h4><ul>\n<li><p>UserMapper.java</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.pojo.User;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//查询所有学生</span></span><br><span class=\"line\">    <span class=\"function\">List&lt;User&gt; <span class=\"title\">getUserList</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号查询学生</span></span><br><span class=\"line\">    <span class=\"function\">User <span class=\"title\">getUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//插入一条学生信息</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addUser</span><span class=\"params\">(User user)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>UserMapper.xml</p>\n<blockquote>\n<ul>\n<li><strong>用”#{}”接收参数</strong></li>\n<li><strong>参数类型是自定义类则需要写全限定类名</strong></li>\n<li><strong>对象中的属性可以直接调用</strong></li>\n</ul>\n</blockquote>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE mapper</span></span><br><span class=\"line\"><span class=\"meta\">        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"com.dao.UserMapper\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">insert</span> <span class=\"attr\">id</span>=<span class=\"string\">\"addUser\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"com.pojo.User\"</span>&gt;</span></span><br><span class=\"line\">        insert into mybatis.user (id, name, pwd) values (#&#123;id&#125;, #&#123;name&#125;, #&#123;pwd&#125;);</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">insert</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>Test.java</p>\n<p><strong>增删改需要提交事务sqlSession.commit</strong></p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//增删改需要提交事务sqlSession.commit</span></span><br><span class=\"line\"><span class=\"comment\">//根据学号删除学生</span></span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteUser</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//第一步：获取SqlSession对象</span></span><br><span class=\"line\">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class=\"line\">    <span class=\"comment\">//执行SQL</span></span><br><span class=\"line\">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class=\"line\">    userMapper.deleteUser(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"comment\">//提交事务</span></span><br><span class=\"line\">    sqlSession.commit();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//关闭sqlSession流</span></span><br><span class=\"line\">    sqlSession.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<h3 id=\"3-3-delete：删除语句\">3.3 delete：删除语句<a href=\"post/Mybatis(1)#3-3-delete：删除语句\"></a></h3><ul>\n<li>id：namespace绑定的Mapper接口中的方法名</li>\n<li>resultType：SQL语句返回结果集<strong>(返回结果类型必须写全限定类名)</strong></li>\n<li>parameterType：参数类型<strong>(用”#{}”接收参数，如果参数类型是自定义类则需要写全限定类名)</strong></li>\n</ul>\n<h4 id=\"示例：根据学号删除学生信息\"><strong>示例：根据学号删除学生信息</strong><a href=\"post/Mybatis(1)#示例：根据学号删除学生信息\"></a></h4><ul>\n<li><p>UserMapper.java</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.pojo.User;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//查询所有学生</span></span><br><span class=\"line\">    <span class=\"function\">List&lt;User&gt; <span class=\"title\">getUserList</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号查询学生</span></span><br><span class=\"line\">    <span class=\"function\">User <span class=\"title\">getUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//插入一条学生信息</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addUser</span><span class=\"params\">(User user)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号删除学生</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">deleteUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>UserMapper.xml</p>\n<p><strong>用”#{}”接收参数</strong></p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE mapper</span></span><br><span class=\"line\"><span class=\"meta\">        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"com.dao.UserMapper\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">delete</span> <span class=\"attr\">id</span>=<span class=\"string\">\"deleteUser\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"int\"</span>&gt;</span></span><br><span class=\"line\">        delete from mybatis.user where id = #&#123;id&#125;;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">delete</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>Test.java</p>\n<p><strong>增删改需要提交事务sqlSession.commit</strong></p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//插入一条学生信息</span></span><br><span class=\"line\">   <span class=\"meta\">@Test</span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">addUser</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">       <span class=\"comment\">//第一步：获取SqlSession对象</span></span><br><span class=\"line\">       SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class=\"line\">       <span class=\"comment\">//执行SQL</span></span><br><span class=\"line\">       UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class=\"line\">       userMapper.addUser(<span class=\"keyword\">new</span> User(<span class=\"number\">1</span>,<span class=\"string\">\"蒋振国\"</span>,<span class=\"string\">\"123456\"</span>));</span><br><span class=\"line\">       <span class=\"comment\">//提交事务</span></span><br><span class=\"line\">       sqlSession.commit();</span><br><span class=\"line\">       <span class=\"comment\">//关闭sqlSession流</span></span><br><span class=\"line\">       sqlSession.close();</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<h3 id=\"3-4-update：更新语句\">3.4 update：更新语句<a href=\"post/Mybatis(1)#3-4-update：更新语句\"></a></h3><ul>\n<li>id：namespace绑定的Mapper接口中的方法名</li>\n<li>resultType：SQL语句返回结果集<strong>(返回结果类型必须写全限定类名)</strong></li>\n<li>parameterType：参数类型<strong>(用”#{}”接收参数，如果参数类型是自定义类则需要写全限定类名)</strong></li>\n</ul>\n<h4 id=\"示例：更新学生信息\">示例：更新学生信息<a href=\"post/Mybatis(1)#示例：更新学生信息\"></a></h4><ul>\n<li><p>UserMapper.java</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.pojo.User;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//查询所有学生</span></span><br><span class=\"line\">    <span class=\"function\">List&lt;User&gt; <span class=\"title\">getUserList</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号查询学生</span></span><br><span class=\"line\">    <span class=\"function\">User <span class=\"title\">getUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//插入一条学生信息</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">addUser</span><span class=\"params\">(User user)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//根据学号删除学生</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">deleteUser</span><span class=\"params\">(<span class=\"keyword\">int</span> id)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">//更新一条学生信息</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">updateUser</span><span class=\"params\">(User user)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>UserMapper.xml</p>\n<p><strong>用”#{}”接收参数</strong></p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE mapper</span></span><br><span class=\"line\"><span class=\"meta\">        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"com.dao.UserMapper\"</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">update</span> <span class=\"attr\">id</span>=<span class=\"string\">\"updateUser\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"com.pojo.User\"</span>&gt;</span></span><br><span class=\"line\">        update mybatis.user set name = #&#123;name&#125;, pwd = #&#123;pwd&#125; where id = #&#123;id&#125;;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">update</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mapper</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>Test.java</p>\n<p><strong>增删改需要提交事务sqlSession.commit</strong></p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//更新一条学生信息</span></span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateUser</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//第一步：获取SqlSession对象</span></span><br><span class=\"line\">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class=\"line\">    <span class=\"comment\">//执行SQL</span></span><br><span class=\"line\">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class=\"line\">    userMapper.updateUser(<span class=\"keyword\">new</span> User(<span class=\"number\">1</span>,<span class=\"string\">\"IU\"</span>,<span class=\"string\">\"0516\"</span>));</span><br><span class=\"line\">    <span class=\"comment\">//提交事务</span></span><br><span class=\"line\">    sqlSession.commit();</span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"comment\">//关闭sqlSession流</span></span><br><span class=\"line\">    sqlSession.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<h2 id=\"4-Map查询\">4 Map查询<a href=\"post/Mybatis(1)#4-Map查询\"></a></h2><blockquote>\n<h4 id=\"适用于实体类-数据库表中字段或属性过多的情况！\"><a href=\"#适用于实体类-数据库表中字段或属性过多的情况！\" class=\"headerlink\" title=\"适用于实体类/数据库表中字段或属性过多的情况！\"></a>适用于实体类/数据库表中字段或属性过多的情况！</h4></blockquote>\n<h3 id=\"4-1-Map查询\">4.1 Map查询<a href=\"post/Mybatis(1)#4-1-Map查询\"></a></h3><blockquote>\n<h5 id=\"仍旧只需修改UserMapper-java、UserMapper-xml和Test测试类即可！\"><a href=\"#仍旧只需修改UserMapper-java、UserMapper-xml和Test测试类即可！\" class=\"headerlink\" title=\"仍旧只需修改UserMapper.java、UserMapper.xml和Test测试类即可！\"></a>仍旧只需修改UserMapper.java、UserMapper.xml和Test测试类即可！</h5></blockquote>\n<h4 id=\"4-1-1-修改UserMapper-java\">4.1.1 修改UserMapper.java<a href=\"post/Mybatis(1)#4-1-1-修改UserMapper-java\"></a></h4><blockquote>\n<p>需要修改的地方只有传入的参数改为Map类</p>\n</blockquote>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.pojo.User;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">UserMapper</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//使用Map方式更新一条学生信息</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">updateUserMap</span><span class=\"params\">(Map&lt;String,Object&gt; map)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<h4 id=\"4-1-2-修改UserMapper-xml\">4.1.2 修改UserMapper.xml<a href=\"post/Mybatis(1)#4-1-2-修改UserMapper-xml\"></a></h4><blockquote>\n<p>需要修改的地方：update标签中传入参数的类型为<strong>map</strong></p>\n<p>与使用常规方法的差别：</p>\n<ul>\n<li>可以只修改部分字段的值</li>\n<li>接收字段值时的标识符无需和实体类中的字段/属性名一致，只需与传入map键值对中的key相同即可<strong>(建议不使用，容易搞混)</strong></li>\n</ul>\n</blockquote>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">update</span> <span class=\"attr\">id</span>=<span class=\"string\">\"updateUserMap\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"map\"</span>&gt;</span></span><br><span class=\"line\">    update mybatis.user set name = #&#123;name&#125;, pwd = #&#123;password&#125; where id = #&#123;id&#125;;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">update</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h4 id=\"4-1-3-修改Test测试类\">4.1.3 修改Test测试类<a href=\"post/Mybatis(1)#4-1-3-修改Test测试类\"></a></h4><blockquote>\n<p>需先建立一个map，将需要修改的字段和其对应的值put，然后调用UserMapper的方法即可</p>\n<p>需要注意的是：<strong>map中的key必须与UserMapper.xml配置文件中用于接收参数的标识符相同</strong>，否则会报<strong>PersistenceException</strong>异常</p>\n</blockquote>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//使用Map方式更新一条学生信息</span></span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateUserMap</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//第一步：获取SqlSession对象</span></span><br><span class=\"line\">    SqlSession sqlSession = MyBatisUtils.getSqlSession();</span><br><span class=\"line\">    <span class=\"comment\">//执行SQL</span></span><br><span class=\"line\">    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class=\"line\">    <span class=\"comment\">//userMapper.updateUser(new User(3,\"IU\",\"0516\"));</span></span><br><span class=\"line\">    Map&lt;String,Object&gt; map = <span class=\"keyword\">new</span> HashMap&lt;String, Object&gt;();</span><br><span class=\"line\">    map.put(<span class=\"string\">\"password\"</span>,<span class=\"string\">\"0516\"</span>);</span><br><span class=\"line\">    map.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"IU\"</span>);</span><br><span class=\"line\">    map.put(<span class=\"string\">\"id\"</span>,<span class=\"number\">3</span>);</span><br><span class=\"line\">    userMapper.updateUserMap(map);</span><br><span class=\"line\">    sqlSession.commit();</span><br><span class=\"line\">    <span class=\"comment\">//关闭sqlSession流</span></span><br><span class=\"line\">    sqlSession.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"4-2传递参数问题\">4.2传递参数问题<a href=\"post/Mybatis(1)#4-2传递参数问题\"></a></h3><p>Map传递参数，直接在SQL中取出key</p>\n<p>对象传递参数，直接在SQL中取出对象的属性</p>\n<p>只有一个基本类型参数的情况下，可以直接在SQL中取到 (即在UserMapper.xml配置文件的crud标签中可以省略参数类型)</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">delete</span> <span class=\"attr\">id</span>=<span class=\"string\">\"deleteUser\"</span> &gt;</span></span><br><span class=\"line\">    delete from mybatis.user where id = #&#123;id&#125;;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">delete</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">delete</span> <span class=\"attr\">id</span>=<span class=\"string\">\"deleteUser\"</span> <span class=\"attr\">parameterType</span>=<span class=\"string\">\"int\"</span>&gt;</span></span><br><span class=\"line\">    delete from mybatis.user where id = #&#123;id&#125;;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">delete</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--两种写法均可，前提是UserMapper类中的deleteUser方法只接收一个基本类型的参数--&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<p>一旦涉及多个参数就用Map或者注解(后续会讲)！</p>\n<h2 id=\"5-模糊查询\">5 模糊查询<a href=\"post/Mybatis(1)#5-模糊查询\"></a></h2><blockquote>\n<h4 id=\"涉及模糊查询时容易引起SQL注入，解决方法主要有以下两点\"><a href=\"#涉及模糊查询时容易引起SQL注入，解决方法主要有以下两点\" class=\"headerlink\" title=\"涉及模糊查询时容易引起SQL注入，解决方法主要有以下两点\"></a>涉及模糊查询时容易引起SQL注入，解决方法主要有以下两点</h4></blockquote>\n<h3 id=\"5-1-Java代码执行的时候传入通配符\">5.1 Java代码执行的时候传入通配符%<a href=\"post/Mybatis(1)#5-1-Java代码执行的时候传入通配符\"></a></h3><figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;User&gt; userList = mapper.getUserLike(<span class=\"string\">\"%I%\"</span>)</span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"5-2-在UserMapper-xml文件的SQL语句的拼接中写死通配符\">5.2 在UserMapper.xml文件的SQL语句的拼接中写死通配符%<a href=\"post/Mybatis(1)#5-2-在UserMapper-xml文件的SQL语句的拼接中写死通配符\"></a></h3><figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"getUser\"</span> <span class=\"attr\">parameter</span>=<span class=\"string\">\"int\"</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"com.pojo.User\"</span>&gt;</span></span><br><span class=\"line\">        select * from mybatis.user where name like \"%\"#&#123;value&#125;\"%\";</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h2 id=\"6-MyBatis配置文件解析\">6 MyBatis配置文件解析<a href=\"post/Mybatis(1)#6-MyBatis配置文件解析\"></a></h2><p>MyBatis 的配置文件包含了会深深影响 MyBatis 行为的设置和属性信息。配置文档的顶层结构如下：</p>\n<figure class=\"highlight plain\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">configuration（配置）</span><br><span class=\"line\">properties（属性）</span><br><span class=\"line\">settings（设置）</span><br><span class=\"line\">typeAliases（类型别名）</span><br><span class=\"line\">typeHandlers（类型处理器）</span><br><span class=\"line\">objectFactory（对象工厂）</span><br><span class=\"line\">plugins（插件）</span><br><span class=\"line\">environments（环境配置）</span><br><span class=\"line\">environment（环境变量）</span><br><span class=\"line\">transactionManager（事务管理器）</span><br><span class=\"line\">dataSource（数据源）</span><br><span class=\"line\">databaseIdProvider（数据库厂商标识）</span><br><span class=\"line\">mappers（映射器）</span><br></pre></td></tr></table></div></figure>\n\n<p>==需要注意的是。所有的标签必须按上述顺序配置，否则报错==</p>\n<h3 id=\"6-1-properties（属性）\">6.1 properties（属性）<a href=\"post/Mybatis(1)#6-1-properties（属性）\"></a></h3><blockquote>\n<p>可以通过properties属性引用外部配置文件。这些属性都是可外部配置且可动态替换的，既可以在典型的 Java 属性文件中配置，亦可通过 properties 元素的子元素来传递。</p>\n</blockquote>\n<h4 id=\"6-1-1-通过Java属性文件配置\">6.1.1 通过Java属性文件配置<a href=\"post/Mybatis(1)#6-1-1-通过Java属性文件配置\"></a></h4><ul>\n<li><p>先在外部properties文件中写好配置(例如数据库连接的一些配置)</p>\n<figure class=\"highlight plain\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">driver=com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">url=jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;userSSL=true&amp;useUnicode=true&amp;characterEncoding=UTF-8</span><br><span class=\"line\">username=root</span><br><span class=\"line\">password=123456</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<p>​    (properties配置文件中可以直接使用”&amp;”，不需要转义)</p>\n<ul>\n<li><p>再在mybatis-config.xml文件中引用配置文件</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">properties</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"db.properties\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">environments</span> <span class=\"attr\">default</span>=<span class=\"string\">\"development\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">environment</span> <span class=\"attr\">id</span>=<span class=\"string\">\"development\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">transactionManager</span> <span class=\"attr\">type</span>=<span class=\"string\">\"JDBC\"</span> /&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dataSource</span> <span class=\"attr\">type</span>=<span class=\"string\">\"POOLED\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"driver\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;driver&#125;\"</span>/&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"url\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;url&#125;\"</span>/&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;username&#125;\"</span>/&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;password&#125;\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dataSource</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">environment</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">environments</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<h4 id=\"6-1-2-通过-properties-元素的子元素\">6.1.2 通过 properties 元素的子元素<a href=\"post/Mybatis(1)#6-1-2-通过-properties-元素的子元素\"></a></h4><p>直接在mybatis-config.xml文件中的<properties>标签中添加配置信息</properties></p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">properties</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"db.properties\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"driver\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.mysql.cj.jdbc.Driver\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"url\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;amp;userSSL=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"username\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"root\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"password\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"123456\"</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<p>==注意：如果同时配置了上述两种方式，优先使用配置文件中的配置信息！==</p>\n<p>如果属性在不只一个地方进行了配置，那么 MyBatis 将按照下面的顺序来加载：</p>\n<ul>\n<li>在 properties 元素体内指定的属性首先被读取。</li>\n<li>然后根据 properties 元素中的 resource 属性读取类路径下属性文件或根据 url 属性指定的路径读取属性文件，并覆盖已读取的同名属性。</li>\n<li>最后读取作为方法参数传递的属性，并覆盖已读取的同名属性。</li>\n</ul>\n<p>因此，通过方法参数传递的属性具有最高优先级，resource/url 属性中指定的配置文件次之，最低优先级的是 properties 属性中指定的属性。</p>\n<h3 id=\"6-2-settings（设置）\">6.2 settings（设置）<a href=\"post/Mybatis(1)#6-2-settings（设置）\"></a></h3><p>完整的settings设置查看MyBatis 3官方文档！</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">settings</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"cacheEnabled\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"lazyLoadingEnabled\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"multipleResultSetsEnabled\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"useColumnLabel\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"useGeneratedKeys\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"autoMappingBehavior\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"PARTIAL\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"autoMappingUnknownColumnBehavior\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"WARNING\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"defaultExecutorType\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"SIMPLE\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"defaultStatementTimeout\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"25\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"defaultFetchSize\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"100\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"safeRowBoundsEnabled\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"mapUnderscoreToCamelCase\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"localCacheScope\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"SESSION\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"jdbcTypeForNull\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"OTHER\"</span>/&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">setting</span> <span class=\"attr\">name</span>=<span class=\"string\">\"lazyLoadTriggerMethods\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"equals,clone,hashCode,toString\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">settings</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h3 id=\"6-3-typeAliases（类型别名）\">6.3 typeAliases（类型别名）<a href=\"post/Mybatis(1)#6-3-typeAliases（类型别名）\"></a></h3><blockquote>\n<p>类型别名是为 Java 类型设置一个短的名字。 它只和 XML 配置有关，存在的意义仅在于用来减少类完全限定名的冗余。</p>\n</blockquote>\n<h4 id=\"6-3-1-方式一：给实体类起别名\">6.3.1 方式一：给实体类起别名<a href=\"post/Mybatis(1)#6-3-1-方式一：给实体类起别名\"></a></h4><ul>\n<li><p>在mybatis-config核心文件中配置别名</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">typeAliases</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">typeAlias</span> <span class=\"attr\">type</span>=<span class=\"string\">\"com.pojo.User\"</span> <span class=\"attr\">alias</span>=<span class=\"string\">\"user\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">typeAlias</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>在UserMapper.xml文件中修改返回参数类型</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"getUserList\"</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"user\"</span>&gt;</span></span><br><span class=\"line\">    select * from mybatis.user;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<h4 id=\"6-3-2-方式二：给包起别名\">6.3.2 方式二：给包起别名<a href=\"post/Mybatis(1)#6-3-2-方式二：给包起别名\"></a></h4><ul>\n<li><p>在mybatis-config核心文件中指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean。每一个在包”com.pojo.User”中的Java Bean，在没有注解的情况下，会使用 Bean 的首字母小写的非限定类名来作为它的别名。</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">typeAliases</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">package</span> <span class=\"attr\">name</span>=<span class=\"string\">\"com.pojo\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<p>若有注解，则别名为其注解值。</p>\n<figure class=\"highlight java\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.pojo;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.type.Alias;\t<span class=\"comment\">//Alias的包</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Alias</span>(<span class=\"string\">\"user\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;......&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>在UserMapper.xml文件中修改返回参数类型</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">id</span>=<span class=\"string\">\"getUserList\"</span> <span class=\"attr\">resultType</span>=<span class=\"string\">\"user\"</span>&gt;</span></span><br><span class=\"line\">    select * from mybatis.user;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ul>\n<h4 id=\"6-3-3-区别\">6.3.3 区别<a href=\"post/Mybatis(1)#6-3-3-区别\"></a></h4><p>方式一适用于实体类较少的情况</p>\n<p>方式二适用于实体类较多的情况</p>\n<p>方式一可以自定义别名，方式二在没有注解的情况下，会使用 Bean 的首字母小写的非限定类名来作为它的别名。若有注解，则别名为其注解值。</p>\n<h3 id=\"6-4-environments（环境配置）\">6.4 environments（环境配置）<a href=\"post/Mybatis(1)#6-4-environments（环境配置）\"></a></h3><blockquote>\n<p>只需掌握：</p>\n<ul>\n<li><p>切换环境(通过id切换环境)</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;   <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">&gt;     <span class=\"tag\">&lt;<span class=\"name\">environments</span> <span class=\"attr\">default</span>=<span class=\"string\">\"development\"</span>&gt;</span>\t\t\t</span><br><span class=\"line\">&gt;       <span class=\"comment\">&lt;!--配置环境，通过id可任意选择--&gt;</span></span><br><span class=\"line\">&gt;       <span class=\"tag\">&lt;<span class=\"name\">environment</span> <span class=\"attr\">id</span>=<span class=\"string\">\"development\"</span>&gt;</span>......<span class=\"tag\">&lt;/<span class=\"name\">environment</span>&gt;</span></span><br><span class=\"line\">&gt;       <span class=\"tag\">&lt;<span class=\"name\">environment</span> <span class=\"attr\">id</span>=<span class=\"string\">\"test\"</span>&gt;</span>......<span class=\"tag\">&lt;/<span class=\"name\">environment</span>&gt;</span></span><br><span class=\"line\">&gt;     <span class=\"tag\">&lt;/<span class=\"name\">environments</span>&gt;</span></span><br><span class=\"line\">&gt;   <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span>   </span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></div></figure>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>MyBatis默认的事务管理器是JDBC，默认的数据源是POOLED</li>\n</ul>\n</blockquote>\n<h4 id=\"6-4-1-environment（环境变量）\">6.4.1 environment（环境变量）<a href=\"post/Mybatis(1)#6-4-1-environment（环境变量）\"></a></h4><ul>\n<li><p>环境元素定义了如何配置环境。</p>\n</li>\n<li><p>MyBatis 可以配置成适应多种环境，但是尽管可以配置多个环境，但每个 SqlSessionFactory 实例只能选择一种环境。</p>\n</li>\n<li><p>默认的环境 ID 一定要匹配其中一个环境 ID。</p>\n</li>\n</ul>\n<h4 id=\"6-4-2-transactionManager（事务管理器）\">6.4.2 transactionManager（事务管理器）<a href=\"post/Mybatis(1)#6-4-2-transactionManager（事务管理器）\"></a></h4><p>在 MyBatis 中有两种类型的事务管理器</p>\n<ul>\n<li><p>JDBC – 这个配置就是直接使用了 JDBC 的提交和回滚设置，它依赖于从数据源得到的连接来管理事务作用域。(==默认配置为JDBC==)</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">transactionManager</span> <span class=\"attr\">type</span>=<span class=\"string\">\"JDBC\"</span>/&gt;</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>MANAGED – 这个配置几乎没做什么。它从来不提交或回滚一个连接，而是让容器来管理事务的整个生命周期默认情况下它会关闭连接，然而一些容器并不希望这样，因此需要将 closeConnection 属性设置为 false 来阻止它默认的关闭行为。(了解有这个东西即可)</p>\n</li>\n</ul>\n<h4 id=\"6-4-3-dataSource（数据源）——连接数据库\">6.4.3 dataSource（数据源）——连接数据库<a href=\"post/Mybatis(1)#6-4-3-dataSource（数据源）——连接数据库\"></a></h4><p>dataSource 元素使用标准的 JDBC 数据源接口来配置 JDBC 连接对象的资源。在 MyBatis 中有三种内建的数据源类型</p>\n<ul>\n<li><p><strong>UNPOOLED</strong>– 这个数据源的实现只是每次被请求时打开和关闭连接。虽然有点慢，但对于在数据库连接可用性方面没有太高要求的简单应用程序来说，是一个很好的选择。(不使用数据库连接池)</p>\n</li>\n<li><p><strong>POOLED</strong>– 这种数据源的实现利用“池”的概念将 JDBC 连接对象组织起来，避免了创建新的连接实例时所必需的初始化和认证时间。<strong>这是一种使得并发 Web 应用快速响应请求的流行处理方式。</strong>(==默认配置为POOLED==)</p>\n<figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dataSource</span> <span class=\"attr\">type</span>=<span class=\"string\">\"POOLED\"</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p><strong>JNDI</strong> – 这个数据源的实现是为了能在如 EJB 或应用服务器这类容器中使用，容器可以集中或在外部配置数据源，然后放置一个 JNDI 上下文的引用。</p>\n</li>\n</ul>\n<h3 id=\"6-5-mappers-映射器\">6.5 mappers(映射器)<a href=\"post/Mybatis(1)#6-5-mappers-映射器\"></a></h3><h4 id=\"6-5-1-方式一：使用相对于类路径的资源引用\">6.5.1 方式一：使用相对于类路径的资源引用<a href=\"post/Mybatis(1)#6-5-1-方式一：使用相对于类路径的资源引用\"></a></h4><figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"UserMapper.xml\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mappers</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h4 id=\"6-5-2-方式二：使用映射器接口实现类的完全限定类名\">6.5.2 方式二：使用映射器接口实现类的完全限定类名<a href=\"post/Mybatis(1)#6-5-2-方式二：使用映射器接口实现类的完全限定类名\"></a></h4><figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 使用映射器接口实现类的完全限定类名 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">mapper</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.dao.UserMapper\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mappers</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<h4 id=\"6-5-3-方式三：将包内的映射器接口实现全部注册为映射器\">6.5.3 方式三：将包内的映射器接口实现全部注册为映射器<a href=\"post/Mybatis(1)#6-5-3-方式三：将包内的映射器接口实现全部注册为映射器\"></a></h4><figure class=\"highlight xml\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 将包内的映射器接口实现全部注册为映射器 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mappers</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">package</span> <span class=\"attr\">name</span>=<span class=\"string\">\"com.pojo\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mappers</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<p>==注意：方式二和方式三具有以下限定条件(因此推荐使用方式一)==</p>\n<ul>\n<li>接口和实现接口的Mapper配置文件必须同名！</li>\n<li>接口和实现接口的Mapper配置文件必须在同一包下！</li>\n</ul>\n<h2 id=\"7-生命周期和作用域\">7 生命周期和作用域<a href=\"post/Mybatis(1)#7-生命周期和作用域\"></a></h2><blockquote>\n<p><strong>作用域和生命周期类是至关重要的，因为错误的使用会导致非常严重的并发问题。</strong></p>\n</blockquote>\n<h3 id=\"7-1-SqlSessionFactoryBuilder\">7.1 SqlSessionFactoryBuilder<a href=\"post/Mybatis(1)#7-1-SqlSessionFactoryBuilder\"></a></h3><ul>\n<li>这个类可以被实例化、使用和丢弃，一旦创建了SqlSessionFactory，就不再需要它了。</li>\n<li>SqlSessionFactoryBuilder 实例的最佳作用域是方法作用域（也就是局部方法变量）。</li>\n</ul>\n<h3 id=\"7-2-SqlSessionFactory\">7.2 SqlSessionFactory<a href=\"post/Mybatis(1)#7-2-SqlSessionFactory\"></a></h3><ul>\n<li>SqlSessionFactory 一旦被创建就应该在应用的运行期间一直存在，没有任何理由丢弃它或重新创建另一个实例。 </li>\n<li>SqlSessionFactory 的最佳作用域是应用作用域。</li>\n<li>最简单的就是使用单例模式或者静态单例模式。</li>\n</ul>\n<h3 id=\"7-3-SqlSession\">7.3 SqlSession<a href=\"post/Mybatis(1)#7-3-SqlSession\"></a></h3><ul>\n<li>每个线程都应该有它自己的 SqlSession 实例。</li>\n<li>SqlSession 的实例不是线程安全的，因此是不能被共享的，所以它的最佳的作用域是请求或方法作用域。</li>\n<li>绝对不能将 SqlSession 实例的引用放在一个类的静态域，甚至一个类的实例变量也不行。 也绝不能将 SqlSession 实例的引用放在任何类型的托管作用域中。</li>\n<li>用完后需要及时关闭，否则资源被占用！</li>\n</ul>\n","prev":{"title":"Java面试","link":"post/Java面试"},"next":{"title":"Java贪吃蛇","link":"post/Java贪吃蛇"},"plink":"http://YIzzzzz.github.io/post/Mybatis(1)/","toc":[{"title":"MyBatis(一)","id":"MyBatis-一","index":"1","children":[{"title":"1 简介","id":"1-简介","index":"1.1","children":[{"title":"1.1 什么是MyBatis","id":"1-1-什么是MyBatis","index":"1.1.1"},{"title":"1.2 如何获得MyBatis","id":"1-2-如何获得MyBatis","index":"1.1.2"},{"title":"1.3 MyBatis的优点","id":"1-3-MyBatis的优点","index":"1.1.3"}]},{"title":"2第一个MyBatis程序","id":"2第一个MyBatis程序","index":"1.2","children":[{"title":"2.1 搭建数据库环境","id":"2-1-搭建数据库环境","index":"1.2.1"},{"title":"2.2 新建普通的Maven项目","id":"2-2-新建普通的Maven项目","index":"1.2.2"},{"title":"2.3 编写MyBatis的核心配置文件","id":"2-3-编写MyBatis的核心配置文件","index":"1.2.3"},{"title":"2.4 编写MyBatis工具类","id":"2-4-编写MyBatis工具类","index":"1.2.4"},{"title":"2.5 编写代码","id":"2-5-编写代码","index":"1.2.5"},{"title":"2.6 编写测试用例","id":"2-6-编写测试用例","index":"1.2.6"},{"title":"2.7 可能会遇到的错误","id":"2-7-可能会遇到的错误","index":"1.2.7"}]},{"title":"3 CRUD(增删改需要提交事务sqlSession.commit)","id":"3-CRUD-增删改需要提交事务sqlSession-commit","index":"1.3","children":[{"title":"3.1 select：查询语句","id":"3-1-select：查询语句","index":"1.3.1"},{"title":"3.2 insert：添加语句","id":"3-2-insert：添加语句","index":"1.3.2"},{"title":"3.3 delete：删除语句","id":"3-3-delete：删除语句","index":"1.3.3"},{"title":"3.4 update：更新语句","id":"3-4-update：更新语句","index":"1.3.4"}]},{"title":"4 Map查询","id":"4-Map查询","index":"1.4","children":[{"title":"4.1 Map查询","id":"4-1-Map查询","index":"1.4.1"},{"title":"4.2传递参数问题","id":"4-2传递参数问题","index":"1.4.2"}]},{"title":"5 模糊查询","id":"5-模糊查询","index":"1.5","children":[{"title":"5.1 Java代码执行的时候传入通配符%","id":"5-1-Java代码执行的时候传入通配符","index":"1.5.1"},{"title":"5.2 在UserMapper.xml文件的SQL语句的拼接中写死通配符%","id":"5-2-在UserMapper-xml文件的SQL语句的拼接中写死通配符","index":"1.5.2"}]},{"title":"6 MyBatis配置文件解析","id":"6-MyBatis配置文件解析","index":"1.6","children":[{"title":"6.1 properties（属性）","id":"6-1-properties（属性）","index":"1.6.1"},{"title":"6.2 settings（设置）","id":"6-2-settings（设置）","index":"1.6.2"},{"title":"6.3 typeAliases（类型别名）","id":"6-3-typeAliases（类型别名）","index":"1.6.3"},{"title":"6.4 environments（环境配置）","id":"6-4-environments（环境配置）","index":"1.6.4"},{"title":"6.5 mappers(映射器)","id":"6-5-mappers-映射器","index":"1.6.5"}]},{"title":"7 生命周期和作用域","id":"7-生命周期和作用域","index":"1.7","children":[{"title":"7.1 SqlSessionFactoryBuilder","id":"7-1-SqlSessionFactoryBuilder","index":"1.7.1"},{"title":"7.2 SqlSessionFactory","id":"7-2-SqlSessionFactory","index":"1.7.2"},{"title":"7.3 SqlSession","id":"7-3-SqlSession","index":"1.7.3"}]}]}]}